
digraph {
	ServerContext [shape=box];
	ServerContext -> Config;
	ServerContext -> Dispatcher [style=bold];

	Dispatcher -> Listeners [dir=both];

	Dispatcher -> SysTree;
	SysTree -> Dispatcher [style=dotted];

	Dispatcher -> Cache [dir=both];
	"Persistent Storage" [shape=cylinder];
	Cache -> "Persistent Storage";

	Listeners -> Sessions [dir=both];
	Sessions -> Stream;

	// cli
	CLI -> Dispatcher;

	// dashboard app
	RestApi -> Dispatcher;

	// auth app
	Auth -> Listeners [dir=both, style=dotted, color=red];
	Auth -> "Password File" [style=dotted, color=red];
	"Auth Database" [shape=cylinder];
	Auth -> "Auth Database" [style=dotted, color=red];

	// hook app
	Dispatcher -> Hook [dir=both, style=dotted, color=red];

	// plugin app
	Dispatcher -> Plugins [dir=both,style=dotted, color=red];

	// gateway app
	Gateway -> Dispatcher [dir=both, style=dotted, color=red];
	ExternalProtocols [shape=record, label="{ CoAP | Stomp | MQTT-SN | LwM2M }"];
	Gateway -> ExternalProtocols [style=dotted, color=red];

	// mqtt bridge app
	Dispatcher -> Bridge [dir=both,style=dotted, color=red];

	// rule engine app
	Dispatcher -> "Rule Engine" [dir=both, style=dotted, color=red];
	"Forward Database" [shape=cylinder];
	"Rule Engine" -> "Forward Database" [style=dotted, color=red];

	// monitor app
	Dispatcher -> Metrix [dir=both, style=dotted, color=red];
	Metrix -> Promethous [style=dotted, color=red];
}
