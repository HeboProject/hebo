
digraph {
	// cli
	CLI -> ServerContext [style=dotted, color=red];

	// dashboard app
	RestApi -> ServerContext [style=dotted, color=red];

	Dashboard -> ServerContext [style=dotted, color=red];

	ServerContext [shape=box];
	ServerContext -> ACL [style=dotted, color=blue];
	ServerContext -> Auth [style=dotted, color=blue];
	ServerContext -> Bridge [style=dotted, color=blue];
	ServerContext -> Gateway [style=dotted, color=blue];
	ServerContext -> Metrix [style=dotted, color=blue];
	ServerContext -> ClusterDispatcher [style=dotted, color=blue];
	ServerContext -> "Rule Engine" [style=dotted, color=blue];
	ServerContext -> SysTree [style=dotted, color=blue];
	ServerContext -> Cache [style=dotted, color=blue];

	ClusterDispatcher -> Dispatcher [dir=both, color=red, style=dotted];

	Dispatcher -> Listeners [dir=both];
	Listeners -> Sessions [dir=both];

	Dispatcher -> SysTree [dir=both];

	Dispatcher -> Cache [dir=both];
	"Persistent Storage" [shape=cylinder];
	Cache -> "Persistent Storage";

	// ACL app
	ACL -> Listeners [dir=both];
	ACL -> "ACL File";
	"ACL Database" [shape=cylinder];
	ACL -> "ACL Database" [style=dotted, color=red];

	// auth app
	Auth -> Listeners [dir=both];
	Auth -> "Password File";
	"Auth Database" [shape=cylinder];
	Auth -> "Auth Database" [style=dotted, color=red];

	// mqtt bridge app
	Dispatcher -> Bridge [dir=both,style=dotted, color=red];

	// gateway app
	Dispatcher -> Gateway [dir=both, style=dotted, color=red];
	ExternalProtocols [shape=record, label="{ CoAP | Stomp | MQTT-SN | LwM2M }"];
	Gateway -> ExternalProtocols [style=dotted, color=red];

	// monitor app
	Dispatcher -> Metrix [dir=both, style=dotted, color=red];
	Metrix -> Promethous [style=dotted, color=red];

	// rule engine app
	Dispatcher -> "Rule Engine" [dir=both, style=dotted, color=red];
	"Forward Database" [shape=cylinder];
	"Rule Engine" -> "Forward Database" [style=dotted, color=red];
}
